---
title: "SEMANA 14"
author: "FLORES TORRES ALICE GERMEN"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## REALIZAR EL ANÁLISIS DE REGRESIÓN, ANÁLISIS UNIVARIADO, MULTIVARIADO

1.  Regresión Lineal Univariada en R y ejecutamos presionando ctrl+enter al final de cada fila que deseemos ejecutar.

    ## #Regresión Lineal Univariada en R

    #Ejemplo aplicado a enfermería #¿La presión arterial sistólica (PAS) depende del IMC?

    **#3.1 Cargar datos (crearemos un dataset simulado)**

```{r}
set.seed(123)
n <- 100
IMC <- rnorm(n, 27, 4)
PAS <- 90 + 1.5*IMC + rnorm(n, 0, 8)
datos <- data.frame(IMC, PAS)
head(datos)
```

**#Ajustar modelo**

```{r}
modelo_uni <- lm(PAS ~ IMC, data = datos)
summary(modelo_uni)
```

**#Gráfico**

```{r}
plot(datos$IMC, datos$PAS, main="PAS vs IMC", xlab="IMC", ylab="PAS")
abline(modelo_uni, lwd=2)
```

## #Regresión univariada

#Dataset: nivel de glucosa (Y) y edad (X).

**#Código usado (R equivalente está después):**

**\# En R sería:**

```{r}
set.seed(123)
Edad <- sample(20:70, 30, replace=TRUE)
Glucosa <- 70 + 0.9*Edad + rnorm(30, 0, 8)
datos <- data.frame(Edad, Glucosa)
```

**#Gráfico (código en R)**

```{r}
plot(Edad, Glucosa,
     main = "Relación entre Edad y Glucosa",
     xlab = "Edad (años)",
     ylab = "Glucosa (mg/dL)",
     pch = 19)

abline(lm(Glucosa ~ Edad), col="blue", lwd=2)
```

## #Regresión multivariada

```{r}
set.seed(123)

n <- 80
IMC <- rnorm(n, 27, 4)
Edad <- rnorm(n, 45, 10)
Grasas <- rnorm(n, 60, 15)

Colesterol <- 95 + 2.1*IMC + 0.85*Edad + 1.45*Grasas + rnorm(n, 0, 15)

datos <- data.frame(IMC, Edad, Grasas, Colesterol)

head(datos)
```

**#Ajustar el modelo múltiple**

```{r}
modelo <- lm(Colesterol ~ IMC + Edad + Grasas, data = datos)
summary(modelo)
```

**#¿Qué variable predice mejor?**

```{r}
summary(modelo)$coefficients
#Conclusión: El consumo de grasas es el predictor más fuerte del colesterol.
```

**#Verificar supuestos del modelo**

```{r}
par(mfrow=c(2,2))
plot(modelo)
```
